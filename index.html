<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Verdad o Reto</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Montserrat:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Montserrat', sans-serif;
            background-image: linear-gradient(to top right, #1a0b2e, #111827, #0d0d1a);
            color: #F3F4F6;
            overflow: hidden;
        }

        .font-title {
            font-family: 'Bebas Neue', cursive;
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        }

        .neon-text-alt {
            text-shadow: 0 0 5px #f472b6, 0 0 15px #f472b6, 0 0 30px #f472b6, 0 0 50px #c026d3;
        }
        
        .btn-primary {
            background-image: linear-gradient(to right, #ec4899, #d946ef, #a855f7);
            transition: all 0.3s ease;
            box-shadow: 0 0 15px rgba(236, 72, 153, 0.4);
        }
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 0 25px rgba(236, 72, 153, 0.7);
        }
        
        .btn-secondary {
             background-image: linear-gradient(to right, #3b82f6, #6366f1);
             transition: all 0.3s ease;
             box-shadow: 0 0 15px rgba(59, 130, 246, 0.4);
        }
        .btn-secondary:hover {
            transform: translateY(-3px);
            box-shadow: 0 0 25px rgba(59, 130, 246, 0.7);
        }

        .btn-tertiary {
             background-image: linear-gradient(to right, #ef4444, #f97316);
             transition: all 0.3s ease;
             box-shadow: 0 0 15px rgba(239, 68, 68, 0.4);
        }
        .btn-tertiary:hover {
            transform: translateY(-3px);
            box-shadow: 0 0 25px rgba(239, 68, 68, 0.7);
        }
        
        .input-field {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .input-field:focus {
            outline: none;
            border-color: #f472b6;
            box-shadow: 0 0 10px #f472b6;
        }

        .modal-enter {
            animation: modal-in 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
        }
        .modal-exit {
            animation: modal-out 0.4s cubic-bezier(0.55, 0.085, 0.68, 0.53) forwards;
        }

        @keyframes modal-in {
            from { opacity: 0; transform: scale(0.9) translateY(20px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }
        @keyframes modal-out {
            from { opacity: 1; transform: scale(1) translateY(0); }
            to { opacity: 0; transform: scale(0.9) translateY(20px); }
        }
        
        .player-name-pulse {
            animation: pulse-glow 2s infinite ease-in-out;
        }

        @keyframes pulse-glow {
            0%, 100% { text-shadow: 0 0 5px #f472b6, 0 0 15px #f472b6, 0 0 30px #f472b6; }
            50% { text-shadow: 0 0 10px #f871b5, 0 0 25px #f871b5, 0 0 50px #d946ef; }
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">

    <div id="app-container" class="w-full max-w-md mx-auto">

        <!-- Pantalla de Configuraci√≥n -->
        <div id="setup-screen" class="glass-card p-6 md:p-8 rounded-2xl space-y-6">
            <h1 class="font-title text-5xl font-bold text-center text-pink-400 neon-text-alt tracking-wider">Verdad o Reto</h1>
            
            <!-- Agregar Jugadores -->
            <div>
                <label class="block text-sm font-medium text-gray-300 mb-2">A√±adir Jugadores</label>
                <div class="grid grid-cols-1 sm:grid-cols-3 gap-2">
                    <input type="text" id="player-input" placeholder="Nombre" class="sm:col-span-2 w-full rounded-lg px-4 py-2 text-white input-field">
                    <select id="gender-select" class="w-full rounded-lg px-4 py-2 text-white input-field">
                        <option value="hombre">Hombre</option>
                        <option value="mujer">Mujer</option>
                    </select>
                </div>
                 <button id="add-player-btn" class="mt-2 w-full text-white font-bold py-2 px-4 rounded-lg btn-primary">A√±adir Jugador</button>
                <div id="players-list" class="mt-4 flex flex-wrap gap-2">
                    <!-- Las etiquetas de los jugadores aparecer√°n aqu√≠ -->
                </div>
            </div>

            <!-- Categor√≠a y Nivel -->
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">Categor√≠a</label>
                    <select id="category-select" class="w-full rounded-lg px-4 py-2 text-white input-field">
                        <option value="normal">Normal</option>
                        <option value="parejas">Parejas</option>
                    </select>
                </div>
                <div>
                    <label for="level-select" class="block text-sm font-medium text-gray-300 mb-2">Nivel</label>
                    <select id="level-select" class="w-full rounded-lg px-4 py-2 text-white input-field">
                        <option value="1">1: Suave</option>
                        <option value="2">2: Intermedio</option>
                        <option value="3">3: Picante üî•</option>
                        <option value="4">4: Extremo üå∂Ô∏è</option>
                        <option value="5">5: GOD üòà</option>
                    </select>
                </div>
            </div>

            <!-- Bot√≥n de Iniciar Juego -->
            <button id="start-game-btn" class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 rounded-lg text-lg disabled:bg-gray-600 disabled:cursor-not-allowed disabled:opacity-50 transition-all duration-300">
                Empezar Juego
            </button>
        </div>

        <!-- Pantalla de Juego -->
        <div id="game-screen" class="hidden glass-card p-6 md:p-8 rounded-2xl text-center space-y-8">
            <h2 class="font-title text-3xl font-bold tracking-wider">Turno de:</h2>
            <p id="current-player-name" class="font-title text-6xl font-extrabold text-pink-400 player-name-pulse"></p>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <button id="truth-btn" class="btn-secondary text-white font-bold py-4 rounded-lg text-2xl font-title tracking-wider">Verdad</button>
                <button id="dare-btn" class="btn-tertiary text-white font-bold py-4 rounded-lg text-2xl font-title tracking-wider">Reto</button>
            </div>
            <button id="end-game-btn" class="w-full mt-4 bg-gray-700 hover:bg-gray-600 text-white font-bold py-2 rounded-lg transition-colors">Terminar Juego</button>
        </div>

    </div>

    <!-- Modal para mostrar Verdad o Reto -->
    <div id="modal-container" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4" style="background-color: rgba(0,0,0,0.7);">
        <div id="modal-content" class="glass-card rounded-2xl w-full max-w-lg p-8 text-center space-y-6">
            <h3 id="modal-title" class="font-title text-4xl font-bold text-pink-400 neon-text-alt tracking-wider"></h3>
            <p id="modal-text" class="text-xl text-gray-200 min-h-[80px]"></p>
            <button id="next-turn-btn" class="w-full text-white font-bold py-3 rounded-lg text-lg btn-primary">Siguiente Turno</button>
        </div>
    </div>

    <script>
        // --- DOM Elements ---
        const setupScreen = document.getElementById('setup-screen');
        const gameScreen = document.getElementById('game-screen');
        const playerInput = document.getElementById('player-input');
        const genderSelect = document.getElementById('gender-select');
        const addPlayerBtn = document.getElementById('add-player-btn');
        const playersList = document.getElementById('players-list');
        const categorySelect = document.getElementById('category-select');
        const levelSelect = document.getElementById('level-select');
        const startGameBtn = document.getElementById('start-game-btn');
        const endGameBtn = document.getElementById('end-game-btn');
        const currentPlayerName = document.getElementById('current-player-name');
        const truthBtn = document.getElementById('truth-btn');
        const dareBtn = document.getElementById('dare-btn');
        const modalContainer = document.getElementById('modal-container');
        const modalContent = document.getElementById('modal-content');
        const modalTitle = document.getElementById('modal-title');
        const modalText = document.getElementById('modal-text');
        const nextTurnBtn = document.getElementById('next-turn-btn');

        // --- Game State ---
        let players = [];
        let currentPlayerIndex = 0;
        let gameSettings = { category: 'normal', level: '1' };

        // --- Database ---
        const questions = {
            normal: {
                '1': { truths: ["¬øCu√°l es la pel√≠cula que m√°s te ha hecho llorar?", "¬øSi pudieras tener un superpoder, cu√°l ser√≠a?", "¬øCu√°l es tu gusto culposo en m√∫sica?"], dares: ["Habla con un acento diferente durante los pr√≥ximos 3 turnos.", "Haz tu mejor imitaci√≥n de un beb√© llorando.", "Dale un cumplido sincero a [COMPA√ëERO_ALEATORIO]."] },
                '2': { truths: ["¬øQu√© es lo m√°s vergonzoso que te ha pasado en una cita?", "¬øCu√°l es la mentira m√°s grande que has dicho sin que te atrapen?", "¬øQu√© es lo m√°s extra√±o que has buscado en Google?"], dares: ["Llama a una pizzer√≠a y pregunta si venden tacos.", "Deja que [COMPA√ëERO_ALEATORIO] te dibuje algo en la cara con un marcador (no permanente).", "Haz un baile sensual durante 30 segundos."] },
                '3': { truths: ["¬øQui√©n de los presentes es el que peor te cae y por qu√©?", "¬øCu√°l es la fantas√≠a m√°s extra√±a que has tenido?", "Describe el momento m√°s caliente que has vivido."], dares: ["Qu√≠tate una prenda de ropa (la que elijas).", "Dale un beso en la mejilla a [COMPA√ëERO_OPUESTO].", "Describe con detalles c√≥mo ser√≠a tu cita perfecta con [COMPA√ëERO_ALEATORIO]."] },
                '4': { truths: ["¬øCu√°l es la parte de tu cuerpo que menos te gusta y por qu√©?", "¬øQu√© es lo m√°s atrevido que har√≠as por un mill√≥n de d√≥lares?", "¬øCu√°l es tu mayor secreto 'inconfesable'?"], dares: ["Hazle un baile er√≥tico a [COMPA√ëERO_OPUESTO].", "Intercambia una prenda de ropa con [COMPA√ëERO_ALEATORIO].", "Permite que [COMPA√ëERO_ALEATORIO] revise tus mensajes directos de Instagram por 1 minuto."] },
                '5': { 
                    truths: [
                        // Contenido Original
                        "Describe la fantas√≠a sexual m√°s perversa que has tenido.",
                        "¬øCu√°l es el video pornogr√°fico m√°s raro que has visto?",
                        "¬øCon cu√°ntas personas de las que est√°n jugando te acostar√≠as?",
                        "¬øQu√© es lo m√°s atrevido que has hecho en p√∫blico relacionado con el sexo?",
                        "¬øAlguna vez has pagado por sexo o contenido expl√≠cito?",
                        "¬øCu√°l es el fetiche m√°s raro que te excita?",
                        "Describe el olor corporal que m√°s te excita en otra persona.",
                        "¬øQu√© es lo m√°s cercano a un acto ilegal que has hecho por excitaci√≥n sexual?",
                        "De los presentes, ¬øa qui√©n te gustar√≠a ver teniendo sexo con otra persona del grupo?",
                        "¬øCu√°l es el objeto m√°s extra√±o que has usado para masturbarte?",
                        "Describe con detalle la √∫ltima vez que te masturbaste: d√≥nde, c√≥mo y pensando en qu√© o qui√©n.",
                        "¬øQu√© es algo sexualmente que te da verg√ºenza admitir que te gusta?",
                        "Si tuvieras que tener sexo con un animal, ¬øcu√°l ser√≠a y por qu√©? (Hipot√©ticamente)",
                        "De los presentes, ¬øqui√©n crees que es el/la mejor en la cama? Justifica tu respuesta.",
                        // Nuevas Preguntas
                        "¬øCu√°l es la mentira m√°s grande que le has dicho a una pareja sobre tu pasado sexual?",
                        "¬øAlguna vez has tenido una experiencia sexual con m√°s de una persona a la vez? Descr√≠bela.",
                        "¬øQu√© es lo m√°s doloroso que has experimentado en el sexo que aun as√≠ te gust√≥?",
                        "Si pudieras ser invisible por un d√≠a, ¬øa qui√©n del grupo espiar√≠as en su intimidad?",
                        "Nombra una categor√≠a de porno que ves en secreto y que nunca admitir√≠as.",
                        "¬øHas grabado o te han grabado alguna vez durante el sexo? ¬øQu√© pas√≥ con ese video/foto?",
                        "¬øCu√°l es tu r√©cord de orgasmos en un solo d√≠a?",
                        "Describe el sabor de los genitales de la √∫ltima persona con la que tuviste sexo oral.",
                        "¬øQu√© es lo m√°s humillante que has hecho o te han hecho en la cama que te haya excitado?",
                        "Si tuvieras que elegir a dos personas de este grupo para hacer un tr√≠o, ¬øqui√©nes ser√≠an?",
                        "¬øAlguna vez has olido la ropa interior usada de alguien por excitaci√≥n?",
                        "¬øCu√°l es el lugar m√°s arriesgado donde has tenido relaciones sexuales?",
                        "¬øQu√© es lo que m√°s te excita de la idea de ser dominado/a o dominar a alguien?",
                        "¬øHas fingido un orgasmo? ¬øCon qui√©n y por qu√©?",
                        "¬øQu√© sonido que hace otra persona durante el sexo te vuelve loco/a?"
                    ], 
                    dares: [
                        // Contenido Original
                        "Qu√≠tate toda la ropa hasta quedar completamente desnudo/a durante 2 turnos.",
                        "Haz una demostraci√≥n de tu mejor gemido de orgasmo, tan fuerte como puedas.",
                        "B√©sate apasionadamente con [COMPA√ëERO_OPUESTO] durante 30 segundos.",
                        "Deja que [COMPA√ëERO_ALEATORIO] elija un video porno para que lo veas durante 1 minuto.",
                        "Ponte a cuatro patas y act√∫a como un perro/a sumiso/a para [COMPA√ëERO_OPUESTO] durante un minuto. √âl/ella puede darte √≥rdenes simples (no sexuales).",
                        "Con los ojos vendados, deja que [COMPA√ëERO_ALEATORIO] te d√© a oler tres partes de su cuerpo y adivina cu√°les son.",
                        "Realiza un striptease completo hasta quedar en ropa interior para el grupo.",
                        "Usa una de tus prendas como mordaza durante los pr√≥ximos 3 turnos.",
                        "Lame una parte del cuerpo de [COMPA√ëERO_OPUESTO] (cuello, brazo, etc.) de la forma m√°s sensual posible.",
                        "Mast√∫rbate delante del grupo durante 1 minuto o hasta que te sientas inc√≥modo/a.",
                        "Elige a [COMPA√ëERO_ALEATORIO]. Tienen que estar en la posici√≥n del 69 durante 2 minutos (con ropa o sin ella, a elecci√≥n).",
                        "Deja que [COMPA√ëERO_OPUESTO] te d√© una nalgada tan fuerte como quiera.",
                        "Tienes que ser el esclavo/a sexual de [COMPA√ëERO_ALEATORIO] durante los pr√≥ximos 3 turnos. Debes obedecer cualquier orden razonable y no peligrosa.",
                        "Simula sexo oral con un objeto (una botella, un pl√°tano) durante un minuto con el mayor realismo posible.",
                        // Nuevos Retos
                        "Elige a [COMPA√ëERO_ALEATORIO]. Debes lamerle desde la barbilla hasta el ombligo.",
                        "Qu√≠tate la ropa interior y √∫sala como un pa√±uelo en la cabeza por el resto del juego.",
                        "Deja que el grupo escriba una palabra obscena en tu frente con un marcador.",
                        "Hazle 'foot-job' (paja con los pies) a [COMPA√ëERO_ALEATORIO] durante un minuto.",
                        "Con los ojos vendados, debes identificar a [COMPA√ëERO_ALEATORIO] solo tocando sus genitales por encima de la ropa.",
                        "Elige a [COMPA√ëERO_OPUESTO]. Deben simular la postura sexual del 'perrito' durante un minuto, gimiendo.",
                        "Muestra tu historial de b√∫squeda de porno en tu tel√©fono al grupo.",
                        "Deja que el grupo te ponga cubitos de hielo en los pezones y la entrepierna.",
                        "Realiza un 'lap dance' (baile er√≥tico en el regazo) a [COMPA√ëERO_ALEATORIO] durante una canci√≥n entera.",
                        "Tienes que oler los pies de todos los jugadores y clasificarlos del mejor al peor olor.",
                        "Hazle sexo oral a una fruta (pl√°tano, pepino) de la forma m√°s realista posible hasta 'terminar'.",
                        "Intercambia tu ropa interior con [COMPA√ëERO_OPUESTO] y √∫sala por el resto del juego.",
                        "Deja que [COMPA√ëERO_ALEATORIO] te ate las manos a la espalda durante los pr√≥ximos 3 turnos.",
                        "Escupe en la boca de [COMPA√ëERO_ALEATORIO] (si ambos consienten).",
                        "Debes permanecer de rodillas en el suelo hasta tu pr√≥ximo turno, como un/a sirviente/a."
                    ] 
                }
            },
            parejas: {
                '1': { truths: ["¬øQu√© fue lo primero que pensaste al ver a tu pareja por primera vez?", "¬øCu√°l es el h√°bito de tu pareja que m√°s te gusta?", "¬øQu√© canci√≥n te recuerda a tu pareja?"], dares: ["Dale un beso apasionado a tu pareja durante 20 segundos.", "Sus√∫rrale algo sexy al o√≠do a tu pareja.", "Dale un masaje en el cuello a tu pareja durante 1 minuto."] },
                '2': { truths: ["¬øCu√°l es el h√°bito m√°s molesto de tu pareja?", "¬øAlguna vez has sentido celos de alguno de sus amigos/as?", "¬øQu√© es algo que te gustar√≠a probar en la intimidad con tu pareja?"], dares: ["Qu√≠tale una prenda de ropa a tu pareja.", "Baila una canci√≥n lenta y rom√°ntica con tu pareja.", "Recrea vuestro primer beso."] },
                '3': { truths: ["¬øCu√°l es tu fantas√≠a sexual n√∫mero uno con tu pareja?", "¬øHas fingido alguna vez en la intimidad? ¬øPor qu√©?", "¬øQu√© es lo que m√°s te excita de tu pareja?"], dares: ["Dale un beso a tu pareja en su parte favorita del cuerpo (que no sea la boca).", "Hazle un striptease de 30 segundos a tu pareja.", "Tu pareja elige una parte de tu cuerpo para besar durante un minuto."] },
                '4': { truths: ["¬øCu√°l es la posici√≥n sexual que menos te gusta y por qu√©?", "¬øHas pensado en alguien m√°s mientras estabas con tu pareja?", "¬øQu√© es lo m√°s vergonzoso que te ha pedido tu pareja en la cama?"], dares: ["Qu√©dense en ropa interior por el resto del juego.", "Jueguen 7 minutos en el para√≠so (o en otra habitaci√≥n).", "El pr√≥ximo reto que le toque a tu pareja, lo tienen que hacer juntos."] },
                '5': { 
                    truths: [
                        // Contenido Original
                        "¬øQu√© es algo que siempre has querido que tu pareja te haga en la cama pero nunca te has atrevido a pedir?",
                        "Describe en detalle c√≥mo fue la mejor vez que tuvieron sexo.",
                        "Si pudieras tener un tr√≠o, ¬øa qui√©n invitar√≠as y por qu√©?",
                        "¬øCu√°l es tu 'palabra segura' o cu√°l te gustar√≠a que fuera?",
                        "¬øQu√© rol (dominante/sumiso) prefieres en la cama y por qu√©?",
                        "Describe una fantas√≠a donde tu pareja no es el/la protagonista.",
                        "¬øQu√© opinas del 'cuckolding' o de ver a tu pareja con alguien m√°s?",
                        "¬øQu√© es lo m√°s degradante (en un buen sentido) que te gustar√≠a que tu pareja te hiciera?",
                        "Si pudieras grabar un video sexual con tu pareja, ¬øcu√°l ser√≠a el guion?",
                        "¬øCu√°l es la parte del cuerpo de tu pareja que m√°s te gusta saborear?",
                        // Nuevas Preguntas
                        "¬øQu√© es lo que tu pareja hace en la cama que secretamente no te gusta tanto?",
                        "Si tuvieras que describir el sabor de tu pareja usando solo tres palabras, ¬øcu√°les ser√≠an?",
                        "¬øCu√°l es la fantas√≠a sexual que tienes que crees que m√°s impactar√≠a o sorprender√≠a a tu pareja?",
                        "¬øCon qu√© amigo/a tuyo/a crees que tu pareja tendr√≠a una aventura si tuviera la oportunidad?",
                        "¬øQu√© es lo m√°s que has llegado a pagar por un juguete sexual para usar juntos?",
                        "¬øHan tenido sexo en un lugar donde corr√≠an un riesgo real de ser atrapados? Descr√≠belo.",
                        "¬øQu√© parte de la rutina diaria de tu pareja te excita de una manera no obvia?",
                        "¬øQu√© opinar√≠as si tu pareja quisiera explorar el BDSM de forma seria?",
                        "¬øCu√°l es el apodo m√°s vergonzoso que le has puesto a los genitales de tu pareja (o a los tuyos)?",
                        "Si pudieras cambiar una sola cosa de su vida sexual, ¬øqu√© ser√≠a y por qu√©?",
                        "¬øAlguna vez has espiado a tu pareja mientras se masturba?",
                        "¬øCu√°l es el l√≠mite que nunca cruzar√≠as en el sexo, ni siquiera por tu pareja?",
                        "Describe con detalle el orgasmo m√°s intenso que tu pareja te ha dado.",
                        "¬øQu√© piensas sobre las relaciones abiertas?",
                        "¬øQu√© es lo que m√°s te excita de tu pareja que no sea f√≠sico?"
                    ], 
                    dares: [
                        // Contenido Original
                        "Qu√≠tense la ropa mutuamente y jueguen el resto de la partida desnudos.",
                        "Tengan sexo oral el uno al otro durante 2 minutos (o vayan a otra habitaci√≥n y h√°ganlo).",
                        "Tu pareja debe atarte y puede hacer lo que quiera contigo durante 5 minutos (con consentimiento y l√≠mites previos).",
                        "Graben un video corto (15 segundos) de ustedes haciendo algo provocador y b√≥rrenlo despu√©s.",
                        "Uno de ustedes se venda los ojos y el otro usa su cuerpo para darle placer usando solo una parte del cuerpo (ej: solo las manos, solo la boca).",
                        "Practiquen 'teasing and denial': uno de ustedes debe excitar al otro tanto como sea posible durante 3 minutos, pero sin permitirle llegar al orgasmo.",
                        "T√∫rnense para susurrarle al otro la cosa m√°s sucia que se les ocurra al o√≠do.",
                        "Tener sexo en la posici√≥n que elija el otro, sin importar si es tu favorita o no.",
                        "Tu pareja te vendar√° los ojos y usar√° comida (chocolate, nata, miel) en tu cuerpo para luego lamerla.",
                        "Realicen la penetraci√≥n (o sim√∫lenla) en una posici√≥n elegida por el grupo durante al menos un minuto.",
                        // Nuevos Retos
                        "Tu pareja debe darte 10 nalgadas, aumentando la intensidad con cada una.",
                        "Deben besarse continuamente mientras uno de los dos intenta quitarle toda la ropa al otro.",
                        "Uno se sienta en una silla, el otro debe hacerle un 'lap dance' hasta que se excite visiblemente.",
                        "Usando solo la boca, deben pasarse un cubito de hielo de uno a otro hasta que se derrita.",
                        "Tu pareja te susurrar√° al o√≠do c√≥mo quiere que le hagas sexo oral, con todo detalle, mientras t√∫ no puedes tocarle.",
                        "Deben masturbarse uno frente al otro hasta llegar al orgasmo.",
                        "Uno de ustedes debe actuar como un completo sumiso/a para el otro durante 10 minutos, obedeciendo √≥rdenes como 'tr√°eme agua', 'masajea mis pies', etc.",
                        "Hagan una llamada telef√≥nica a un amigo/a y finjan tener un orgasmo mientras hablan de algo normal.",
                        "Deben lamerse mutuamente una parte del cuerpo elegida por el otro al mismo tiempo.",
                        "Tu pareja te vendar√° los ojos y te dar√° a probar 3 cosas de la cocina. Debes adivinar qu√© son solo con el gusto.",
                        "Uno debe escribir con la lengua una palabra 'sucia' en la espalda del otro, y este debe adivinarla.",
                        "Deben recrear su primera vez juntos, pero de la forma m√°s torpe y exagerada posible.",
                        "Tienen que darse de comer el uno al otro de forma muy sensual, usando las manos.",
                        "Tu pareja tiene que 'adorar' tus pies, bes√°ndolos y masaje√°ndolos durante 2 minutos.",
                        "Deben tener una 'pelea' de besos, donde el objetivo es ser el que besa de forma m√°s dominante y apasionada."
                    ] 
                }
            }
        };

        // --- Functions ---
        
        function updatePlayersUI() {
            playersList.innerHTML = '';
            players.forEach((player, index) => {
                const playerTag = document.createElement('span');
                const genderIcon = player.gender === 'hombre' 
                    ? `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-gender-male" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M9.5 2a.5.5 0 0 1 0-1h5a.5.5 0 0 1 .5.5v5a.5.5 0 0 1-1 0V2.707L9.871 6.836a5 5 0 1 1-.707-.707L13.293 2H9.5zM6 6a4 4 0 1 0 0 8 4 4 0 0 0 0-8z"/></svg>`
                    : `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-gender-female" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8 1a4 4 0 1 0 0 8 4 4 0 0 0 0-8zM3 5a5 5 0 1 1 5.5 4.975V12h2a.5.5 0 0 1 0 1h-2v2.5a.5.5 0 0 1-1 0V13h-2a.5.5 0 0 1 0-1h2V9.975A5 5 0 0 1 3 5z"/></svg>`;
                playerTag.className = 'flex items-center gap-2 bg-black bg-opacity-20 text-white text-sm font-medium px-3 py-1 rounded-full';
                playerTag.innerHTML = `<span>${player.name}</span> <span class="text-pink-400">${genderIcon}</span>`;
                
                const removeBtn = document.createElement('button');
                removeBtn.textContent = '√ó';
                removeBtn.className = 'text-gray-400 hover:text-white font-bold text-lg leading-none -mr-1';
                removeBtn.onclick = () => removePlayer(index);
                
                playerTag.appendChild(removeBtn);
                playersList.appendChild(playerTag);
            });
            checkCanStart();
        }

        function addPlayer() {
            const playerName = playerInput.value.trim();
            const gender = genderSelect.value;
            if (playerName && !players.some(p => p.name === playerName)) {
                players.push({ name: playerName, gender: gender });
                playerInput.value = '';
                updatePlayersUI();
            }
            playerInput.focus();
        }

        function removePlayer(index) {
            players.splice(index, 1);
            updatePlayersUI();
        }
        
        function checkCanStart() {
            if (categorySelect.value === 'parejas') {
                 startGameBtn.disabled = players.length !== 2;
            } else {
                 startGameBtn.disabled = players.length < 2;
            }
        }
        
        categorySelect.addEventListener('change', checkCanStart);

        function startGame() {
            if (startGameBtn.disabled) return;
            
            gameSettings.category = categorySelect.value;
            gameSettings.level = levelSelect.value;
            currentPlayerIndex = Math.floor(Math.random() * players.length);

            setupScreen.classList.add('hidden');
            gameScreen.classList.remove('hidden');
            
            updateGameUI();
        }

        function endGame() {
            gameScreen.classList.add('hidden');
            setupScreen.classList.remove('hidden');
        }

        function updateGameUI() {
            currentPlayerName.textContent = players[currentPlayerIndex].name;
        }
        
        function getPartner(type) {
            const currentPlayer = players[currentPlayerIndex];
            const otherPlayers = players.filter((_, index) => index !== currentPlayerIndex);

            if (otherPlayers.length === 0) return null;

            if (type === 'opposite') {
                const oppositeGender = currentPlayer.gender === 'hombre' ? 'mujer' : 'hombre';
                const potentialPartners = otherPlayers.filter(p => p.gender === oppositeGender);
                
                if (potentialPartners.length > 0) {
                    return potentialPartners[Math.floor(Math.random() * potentialPartners.length)];
                }
            }
            
            return otherPlayers[Math.floor(Math.random() * otherPlayers.length)];
        }

        function showQuestion(type) {
            const { category, level } = gameSettings;
            const options = questions[category][level][type === 'truth' ? 'truths' : 'dares'];
            let text = options[Math.floor(Math.random() * options.length)];

            if (text.includes('[COMPA√ëERO_OPUESTO]')) {
                const partner = getPartner('opposite');
                text = partner ? text.replace(/\[COMPA√ëERO_OPUESTO\]/g, partner.name) : text.replace(/\[COMPA√ëERO_OPUESTO\]/g, 'alguien');
            }
            if (text.includes('[COMPA√ëERO_ALEATORIO]')) {
                const partner = getPartner('random');
                text = partner ? text.replace(/\[COMPA√ëERO_ALEATORIO\]/g, partner.name) : text.replace(/\[COMPA√ëERO_ALEATORIO\]/g, 'alguien');
            }

            modalTitle.textContent = type === 'truth' ? 'Verdad' : 'Reto';
            modalText.textContent = text;
            showModal();
        }
        
        function showModal() {
            modalContainer.classList.remove('hidden');
            modalContent.classList.remove('modal-exit');
            modalContent.classList.add('modal-enter');
        }

        function hideModal() {
            modalContent.classList.remove('modal-enter');
            modalContent.classList.add('modal-exit');
            setTimeout(() => {
                modalContainer.classList.add('hidden');
            }, 400); // Duraci√≥n de la animaci√≥n de salida
        }

        function nextTurn() {
            currentPlayerIndex = (currentPlayerIndex + 1) % players.length;
            hideModal();
            updateGameUI();
        }

        // --- Event Listeners ---
        addPlayerBtn.addEventListener('click', addPlayer);
        playerInput.addEventListener('keyup', (e) => {
            if (e.key === 'Enter') {
                addPlayer();
            }
        });
        
        startGameBtn.addEventListener('click', startGame);
        endGameBtn.addEventListener('click', endGame);
        
        truthBtn.addEventListener('click', () => showQuestion('truth'));
        dareBtn.addEventListener('click', () => showQuestion('dare'));
        
        nextTurnBtn.addEventListener('click', nextTurn);
        modalContainer.addEventListener('click', (e) => {
            if (e.target === modalContainer) {
               nextTurn();
            }
        });

        // --- Initial call ---
        checkCanStart();

    </script>
</body>
</html>
